

<!-- feed it through our cssmin filter to minify -->
<style>
  body{font-family:sans-serif;margin:20px;font-size:small;width:90%;margin-right:auto;margin-left:auto;padding-top:15px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:small;margin-bottom:1px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding-right:20px}.post .post-contents{background:#f7f7f7;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}.post .text{height:200px;padding:20px}@media (max-width:680px){.post{width:100%}}body{font:13px/1.5 Verdana,Helvetica,Arial,sans-serif;width:80%}.img-with-caption{font-size:14px;text-align:center;margin:20 0;background-color:F1F1F1;padding:10px}#pullout{text-align:center}#intro{max-width:700px;display:inline-block;text-align:left}#post-content{max-width:800px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:medium;margin-bottom:1px}ol,ul{max-width:650px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding:0 20px 20px 0}.contribute{width:100%;padding-top:10px}.post .post-contents{border-radius:10px;padding:20px 20px 10px 20px}.post .project-contents{background:#add8e6;border-radius:10px;padding:20px 20px 10px 20px}.post .podcast-contents{background:#e9967a;border-radius:10px;padding:20px 20px 10px 20px}.post .note-contents{background:#e6e6fa;border-radius:10px;padding:20px 20px 10px 20px}.post .pedagogy-contents{background:#90ee90;border-radius:10px;padding:20px 20px 10px 20px}.post .talk-contents{background:pink;border-radius:10px;padding:20px 20px 10px 20px}.post .inter-contents{background:#add8e6;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}img{max-height:500px;max-width:100%}table{margin:30 auto 30 auto;padding:10px;width:60%;text-align:left}td{padding:10px;text-align:left;font-size:12}.post .text{min-height:250px;padding:5px}.post .inter-text{height:250px}audio{width:100%;height:30px}@media (max-width:1100px){.post{width:100%}table{width:100%}}
</style>


<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="/img/edge_favicon.png" />

    <title>Edge Collective</title>
  </head>
  <body>
    <!--<img src="/img/edge_medium.png" id="profile_pic"/>-->
<div id='pullout'>
<img src="/img/edge_flower_medium.png">
<h1> Edge Collective </h1>
<!--
*Accessible infrastructure for communities living at ‘the edge'.*
-->
<p><a href="#podcast">Podcast</a> | <a href="#projects">Projects</a> | <a href="#guides">Guides</a> | <a href="#talks">Presentations</a> | <a href="#notebook">Research</a></p>
<div id='intro'>
<p><a href="/about">Edge Collective</a> is a distributed <strong>research</strong>, <strong>teaching</strong>, and <strong>facilitation</strong> cooperative working to help individuals and communities increase the capacity of their vital <strong>food</strong>, <strong>water</strong>, <strong>energy</strong>, and <strong>communications infrastructure</strong> to adapt to challenging environments. All of the research, designs, and code that we produce is <a href="https://github.com/edgecollective">freely available online</a>.  We support work through <a href="https://opencollective.com/edgecollective">donations</a> and via 'pay-as-you-can' arrangements. Cheers!</p>
<!-- <p><a href="http://edgecollective.io">edgecollective.io</a> | contact us at: collaborate @ edgecollective.io</p>-->
</div>
</div>
<h1><a name="podcast"></a>Podcast</h1>
<p>If you'd like to help support our podcast, you can now do so via <a href="https://www.patreon.com/edgecollective">Patreon</a>. Thanks!</p>
<div class="posts-area">
  <div class="post">
    <div class="podcast-contents">
      <div class="image">
        <a href="/posts/podcast/tom/">
          <img src="img/tom.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/podcast/tom/">The Future of Small Farms</a></h3>
        <p><audio controls id="music"><source src="/audio/tom_audio.m4a" type="audio/mpeg">Your browser does not support the audio element.</audio> </br> </br> Interview with Tom Prohl of Wolfesneck Farm.</p>
        <em>Recorded: 2020-05-19</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="podcast-contents">
      <div class="image">
        <a href="/posts/podcast/libre/">
          <img src="img/talks/libre.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/podcast/libre/">Stewarding Technological Freedom in Agriculture</a></h3>
        <p><audio controls id="music"><source src="/audio/libre.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio> </br> </br> Discussion with Mike Stenta, Jamie Gaehring, and Don Blair.  Originally recorded for LibrePlanet2020.</p>
        <em>Recorded: 2020-03-13</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="podcast-contents">
      <div class="image">
        <a href="/posts/podcast/hamish/">
          <img src="img/talks/hamish.jpeg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/podcast/hamish/">A History of IndyMedia</a></h3>
        <p><audio controls id="music"><source src="/audio/hamish_indymedia_cop25.mp3" type="audio/mpeg">Your browser does not support the audio element.</audio> </br> </br> Interview with Hamish Campbell about his perspective on -- and role in -- the history of IndyMedia.</p>
        <em>Recorded: 2019-12-06</em>
      </div>
    </div>
  </div>
</div>
<h1><a name="projects"></a>Projects</h1>
<div class="posts-area">
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/chappy/">
          <img src="img/chappy/chap_front.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/chappy/">Water Level Monitoring on Chappaquiddick Island, Massachusetts (USA)</a></h3>
        <p>Radio + WiFi + Ultrasonic tide monitoring.</p>
        <em>Updated: 2020-07-17</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/wnf/">
          <img src="img/wnf/greenhouse.JPG"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/wnf/">Greenhouse Monitoring at Wolfe's Neck Farm in Freeport, Maine (USA).</a></h3>
        <p>Setting up a LoRa- and WiFi- based greenhouse monitoring system.</p>
        <em>Updated: 2020-05-11</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/floodsense/">
          <img src="img/nola/flood_sensor.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/floodsense/">Flood Sensing in New Orleans, Louisiana (USA)</a></h3>
        <p>Collaborating on the FloodSense project with NOLAFlotilla.</p>
        <em>Updated: 2020-05-11</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/valedalama/">
          <img src="/img/valedalama/cover.JPG"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/valedalama/">Soil and Greenhouse Monitoring in Odiáxere, Faro District (Portugal)</a></h3>
        <p>Prototyping a LoRa- and wifi-based system for Soil moisture and temperature, as well as ambient temperature humidty and soil temperture inside a greenhouse.</p>
        <em>Updated: 2020-05-08</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/colorado/">
          <img src="/img/harold/fields.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/colorado/">Soil Monitoring System in Olathe, Colorado (USA)</a></h3>
        <p>Developing a Free and Open Source LoRa-based system (softwarre, hardware); prototyping a remote node for capturing relaying data from an SDI-12 - based soil moisture sensor.</p>
        <em>Updated: 2020-05-10</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/belfast/">
          <img src="img/belfast/belfast.jpeg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/belfast/">Coastal Tide Monitoring in Belfast, Maine (USA)</a></h3>
        <p>(With Dave Sprague and friends in Belfast, ME -- water level via Radio + WiFi + pressure sensor.</p>
        <em>Updated: 2020-02-17</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="project-contents">
      <div class="image">
        <a href="/posts/projects/knuth/">
          <img src="/img/field_1/cell_kit.JPG"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/projects/knuth/">Soil Monitoring System in Mead, Nebraska (USA)</a></h3>
        <p>Developing a system for capturing soil moisture measurements from a remote field site, using wifi, LoRa, and cellular communications.</p>
        <em>Updated: 2019-07-24</em>
      </div>
    </div>
  </div>
</div>
<h1><a name="guides"></a>Guides</h1>
<div class="posts-area">
  <div class="post">
    <div class="pedagogy-contents">
      <div class="image">
        <a href="/posts/tutorials/circuitpy_farmos/">
          <img src="img/circuitpy_lora/circuitpy_farmos.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/tutorials/circuitpy_farmos/">Using Circuitpython to send data to FarmOS</a></h3>
        <p>Connecting a Circuitpython sensor to FarmOS, using a 'remote node' + 'single-channel gateway' approach.  Specific example uses an Adafruit ItsyBitsy M4, Adafruit LoRa Breakout, and Adafruit Airlift Breakout</p>
        <em>Updated: 2020-05-15</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="pedagogy-contents">
      <div class="image">
        <a href="/posts/tutorials/circuitpy_lora/">
          <img src="img/circuitpy_lora/circuitpy_lora_demo.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/tutorials/circuitpy_lora/">Simple Circuitpython LoRa Demo</a></h3>
        <p>Simple Circuipython LoRa radio send & receive demo.</p>
        <em>Updated: 2020-05-11</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="pedagogy-contents">
      <div class="image">
        <a href="/posts/tutorials/local_lora/">
          <img src="img/local_first_lora/local_first_snap.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/tutorials/local_lora/">Local First Lora Networks</a></h3>
        <p>Developing a design for a 'local first' approach to farm networking.</p>
        <em>Updated: 2020-05-01</em>
      </div>
    </div>
  </div>
</div>
<h1><a name="talks"></a>Presentations</h1>
<div class="posts-area">
  <div class="post">
    <div class="talk-contents">
      <div class="image">
        <a href="/posts/talks/datcon2020/">
          <img src="img/talks/using_dat.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/talks/datcon2020/">Using Dat & Hyper in Agroecology</a></h3>
        <p>Video of talk 'Using Dat & the Hyper Stack in Agroecology', presented at the 2020 Dat Conference.</p>
        <em>Updated: 2020-08-15</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="talk-contents">
      <div class="image">
        <a href="/posts/talks/degrowthvienna_2020/">
          <img src="img/notes/degrowth.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/talks/degrowthvienna_2020/">Design Patterns for Degrowth ICT</a></h3>
        <p>Video of talk 'Design Patterns for Degrowth ICT', presented at Degrowth Vienna 2020, as well as at SCORAI 2020.</p>
        <em>Updated: 2020-06-14</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="talk-contents">
      <div class="image">
        <a href="/posts/talks/libreplanet_2020/">
          <img src="img/notes/stewarding.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/talks/libreplanet_2020/">Stewarding Technological Freedom in Agriculture</a></h3>
        <p>Video of talk presented at the LibrePlanet2020 conference by Mike Stenta, Jamie Gaehring, and Don Blair</p>
        <em>Updated: 2020-04-14</em>
      </div>
    </div>
  </div>
</div>
<h1><a name="notebook"></a>Research Notebook</h1>
<div class="posts-area">
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/conductivity/">
          <img src="img/placeholder.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/conductivity/">DIY Conductivity Sensor</a></h3>
        <p>Notes on devlepment of DIY conductivity sensors</p>
        <em>Updated: 2020-10-01</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/co2/">
          <img src="img/placeholder.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/co2/">DIY CO2 Monitoring</a></h3>
        <p>Notes on inexpensive CO2 monitoring options</p>
        <em>Updated: 2020-09-28</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/heltec/">
          <img src="img/placeholder.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/heltec/">Inexpensive Heltec WiFi + LoRa Gateway Setup</a></h3>
        <p>Notes on setting up a Heltec device.</p>
        <em>Updated: 2020-09-24</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/lincoln/">
          <img src="img/lincoln/mesh.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/lincoln/">Radiohead LoRa Mesh Field Test</a></h3>
        <p>Test of Radiohead mesh networking functionality.</p>
        <em>Updated: 2020-09-14</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/mothbot/">
          <img src="/img/mothbot/mothbot.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/mothbot/">Mothbot Prototyping</a></h3>
        <p>Prototyping the Mothbot -- an Arduino-compatible LoRa node for remote monitoring applications.</p>
        <em>Updated: 2020-09-27</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/newfound/">
          <img src="img/newfound/IMG_20200830_111611868_HDR.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/newfound/">Meshtastic Test at Newfound Lake</a></h3>
        <p>Using the Meshtastic Python API to perform some basic range tests of the Meshtastic system at Newfound Lake in Bristol, NH.</p>
        <em>Updated: 2020-08-30</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/proto1/">
          <img src="/img/proto1/proto.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/proto1/">Low Power experiments with SAMD21</a></h3>
        <p>Seeing what low current sleep modes are possible with various hardware designs.</p>
        <em>Updated: 2020-09-14</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/signal_strength/">
          <img src="/img/signal_strength/fresnel.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/signal_strength/">Predicting Line-of-Sight Locations</a></h3>
        <p>Collecting tools for estimating line-of-sight locations based on topography.</p>
        <em>Updated: 2020-08-27</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/ssb/">
          <img src="/img/Hermies.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/ssb/">Custom Location for Secure Scuttlebutt Data</a></h3>
        <p>How to set up a custom database directory location for Secure Scuttlebutt (SSB) (enabling e.g. storage of SSB on a portable drive).</p>
        <em>Updated: 2020-08-26</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/simplemesh/">
          <img src="/img/proto2/proto.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/simplemesh/">Simple LoRa Mesh</a></h3>
        <p>Experiments with the Radiohead RHMesh approach.</p>
        <em>Updated: 2020-08-22</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/quahogdebug/">
          <img src="img/notebook/quahog_debug/q_debug.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/quahogdebug/">Quahog Debug</a></h3>
        <p>Revising the Quahog ESP32 + LoRa circuit</p>
        <em>Updated: 2020-08-27</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/mesh/">
          <img src="img/mesh/hello.png"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/mesh/">Meshtastic LoRa Mesh Chat</a></h3>
        <p>Experimenting with the Meshtastic system for Android + Bluetooth + LoRa mesh networking.</p>
        <em>Updated: 2020-09-27</em>
      </div>
    </div>
  </div>
  <div class="post">
    <div class="note-contents">
      <div class="image">
        <a href="/posts/notes/lorad/">
          <img src="img/lorad/rough.jpg"/>
        </a>
      </div>
      <div class="text">
        <h3><a href="/posts/notes/lorad/">DIY Low Power Radio Nodes</a></h3>
        <p>Building radio nodes with an eye towards easy assembly and easy sourcing of parts.</p>
        <em>Updated: 2020-08-03</em>
      </div>
    </div>
  </div>
</div>
<!--
# Notes 

<div class="posts-area">

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Rough prototype</h2>
<p>Using a JeeNode and a LoRA FeatherWing ... sleeping at 6 uA!</p>
<p><img src="/img/lorad/rough.jpg" alt="jee"></p>
<h2>LoRa Ra-01</h2>
<p><a href="https://www.openhardware.io/view/395/LoRa-Ra-01-ATmega328P-Node">LoRa Ra-01</a></p>
<p><img src="/img/lorad/node.jpg" alt="lorad"></p>
<h2>JeeNode</h2>
<p><a href="https://jeelabs.org/2009/12/06/building-the-jeenode-v4/">Assembling the JeeNode</a></p>
<p><img src="/img/lorad/jee_assemble.jpg" alt="jee_assemble"></p>
<h2>LoRaWAN MiniBrick</h2>
<p><a href="https://www.tindie.com/products/lps/lorawan-minibrick/">MiniBrick</a></p>
<p><img src="/img/lorad/minibrick.jpg" alt="minibrick"></p>
<h2>Misc Notes</h2>
<p>Using the 328p's internal crystal;  and adding a bootloader -- described <a href="https://www.hackster.io/techmirtz/arduino-without-external-clock-crystal-on-atmega328-d4fcc4">here</a>.</p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Meshtastic Overview</h2>
<p>Some notes on our experiments with the <a href="https://www.meshtastic.org/">Meshtastic Project</a>.</p>
<p>Check out their <a href="https://meshtastic.letstalkthis.com/">beginner's guide</a>, and their <a href="https://meshtastic.discourse.group/">discussion forum</a>, and watch Andreas Spiess' review of the project:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/TY6m6fS8bxU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/arrow.png"> <img src="/img/mesh/arrow.png" alt="arrow"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2>Heltec Boards</h2>
<p>Picked up some <a href="https://heltec.org/project/wifi-lora-32/">Heltec WiFi LoRa 32 V2</a> boards -- one of the official ports of the Meshtastic project.  Was very easy to get up and running.  Did a quick test by controlling one of the devices (taped in my home window) via a Python script on a PC (using the Meshtastic-python API), and using it to send out pings every 10 seconds to the network; meanwhile I drove around the neighborhood with the other device connected to my Android phone via Bluetooth.</p>
<p>Here's a nice description of the <a href="https://community.hiveeyes.org/t/heltec-wifi-lora-32/3125">Heltec pinout</a>.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/receiving.png"> <img src="/img/mesh/receiving.png" alt="receiving"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/sender_code.png"> <img src="/img/mesh/sender_code.png" alt="sender_code"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/sending.png"> <img src="/img/mesh/sending.png" alt="sending"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/update1/driving.jpeg"> <img src="/img/mesh/update1/driving.jpeg" alt="driving"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/update2/bin.png"> <img src="/img/mesh/update2/bin.png" alt="bin"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/update2/window.png"> <img src="/img/mesh/update2/window.png" alt="window"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/update2/Screenshot_2020-08-16_12-06-16.png"> <img src="/img/mesh/update2/Screenshot_2020-08-16_12-06-16.png" alt="Screenshot_2020-08-16_12-06-16"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2>Quahog</h2>
<p>Got Meshtastic up and running on a <a href="https://edgecollective.io/post/notes/mesh/">Quahog</a> -- a relatively easy-to-assemble ESP32 + RFM9X design.  Just required modifying the 'heltec' LoRa radio GPIO settings in configuration.h in the source code and compiling using Platform.io, as per suggestions on the Meshtastic discourse forum.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/meshtastic.jpeg"> <img src="/img/mesh/meshtastic.jpeg" alt="meshtastic"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Meshtastic running on a Quahog.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mesh/update3/qtest.jpg"> <img src="/img/mesh/update3/qtest.jpg" alt="qtest"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">First message received on the Quahog.</td>
</tr>
</tbody>
</table>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>fixing the bootloader</h2>
<p><a href="https://github.com/espressif/esptool/wiki/ESP32-Boot-Mode-Selection">ESP32 boot mode selection</a></p>
<p>Upshot -- for <a href="https://github.com/edgecollective/hog32">hog32a</a> version:</p>
<ul>
<li>get rid of R4 and C4</li>
<li>place R1, C3, R2, R3, Q1, and Q2</li>
<li>need to connect pin 2 to ground (or it can float; but currently it is used in i2c, and is pulled high with a resistor, so we need to connect it to ground)</li>
<li>need to connect the 'DTR' pin on the CP2104 breakout to the DTR pin on the quahog</li>
</ul>
<p>Once these are done, the board will enter the bootloader automatically.</p>
<h2>flashing using esptool</h2>
<p>Looks like we need to convert the .elf file to a binary image ...</p>
<p>See the <a href="https://github.com/espressif/esptool">guide to esptool</a></p>
<blockquote>
<p>For esp32, elf2image produces a single output binary &quot;image file&quot;. By default this has the same name as the .elf file, with a .bin extension. ie:</p>
</blockquote>
<pre><code>    esptool.py --chip esp32 elf2image my_esp32_app.elf
</code></pre>
<blockquote>
<p>In the above example, the output image file would be called my_esp32_app.bin.</p>
</blockquote>
<p>Actually, checking just now -- platformio generates a 'bin' file directly, so no worries.</p>
<p>need to upload the partitions, too? See <a href="https://github.com/espressif/arduino-esp32/issues/3409">this issue</a></p>
<p><a href="https://robotzero.one/arduino-ide-partitions/">arduino esp32 partitions scheme</a></p>
<p>Setting up <a href="https://www.youtube.com/watch?v=j-Nz14qaNIw">Heltec ESP32 on Arduino</a></p>
<h2>What is working</h2>
<p>If I first erase the chip using:</p>
<pre><code>python esptool.py --chip esp32 erase_flash
</code></pre>
<p>And then use 'adafruit esp32 feather' in the board setup in arduino ide, it seems to just work.  Not sure if I needed simply to erase the flash beforehand.</p>
<h2>Button on Meshtastic</h2>
<p>I was getting 'button press functionality' when running Meshtastic on the Quahog.  I needed to change the quahog Mestastic-device code so that the 'button' was no longer GPIO 0 (default), but GPIO 19 (other pins may also work for this).  This corresponds to 'release/latest/quahog_firmware_v3.bin' in Meshtastic-device-quahog on github.</p>
<h2>Rationale for Quahog</h2>
<p>'Off-grid wifi gateway' ... is this useful?</p>
<p>I guess if you want the Quahog up on a pole ... up to 100 feet away from the wifi gateway... then it can be powered by 12V ... so that might be useful in some circumstances ...</p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Overview</h2>
<p>LoRa connectivity (ISM band 900 Mhz in the US) is highly dependent on line-of-sight.  This can be a challenge in many topologies of interest (urban, with buildings; rural, with trees / hills). The typical solution -- mounting a gateway at a very high location, in an attempt to achieve line-of-sight to remote nodes -- is not always feasible.</p>
<p>Non line-of-sight connections are still possible -- they are just very unreliable, and signal strength / connectivity may fluctuate based on the precise orientation and location of any intermediate objects / ground cover.</p>
<p>This is why a 'mesh' networking setup for lora sensor nodes becomes very appealing; one might be able to deploy 'self-healing' collections of nodes that can pass messages along via a chain of connections.</p>
<h2>References</h2>
<p>Basing my experiments on a fantastic writeup by nootropicdesign -- <a href="https://nootropicdesign.com/projectlab/2018/10/20/lora-mesh-networking/">LoRa Mesh Networking with Simple Arduino-Based Modules</a>, and its associated <a href="https://github.com/nootropicdesign/lora-mesh">source code on github</a>.</p>
<p>Also note that there is an RH MESH client example <a href="https://www.airspayce.com/mikem/arduino/RadioHead/rf22_mesh_client_8pde-example.html">here</a> -- though it is currently based on the RF22 radio.</p>
<p>Also notice the other examples of mesh servers and clients <a href="https://www.airspayce.com/mikem/arduino/RadioHead/examples.html">here</a>.</p>
<h2>Near-term Goals</h2>
<ul>
<li>Understanding the flow of data through the mesh to a target node from a source node;</li>
<li>Visualizing the flow of data</li>
<li>Adding GPS in order to track location of at least the source node;</li>
<li>Testing the memory impact on the 328p of using N nodes</li>
</ul>
<h2>Experiments</h2>
<p>I believe that the standard appproach to mesh networking might be simpler than the nootropic design example.  It might simply involve a mesh 'server', and then mesh 'clients'.</p>
<p>A simple verison might only have two types of node:</p>
<ul>
<li>a <a href="https://www.airspayce.com/mikem/arduino/RadioHead/rf22_mesh_server1_8pde-example.html">simple server</a>; and</li>
<li>a <a href="https://www.airspayce.com/mikem/arduino/RadioHead/rf22_mesh_client_8pde-example.html">simple client</a>.</li>
</ul>
<p>Server side:
<img src="/img/proto2/simple_works_server.png" alt="simple works server"></p>
<p>Client side:
<img src="/img/proto2/simple_works.png" alt="simple works"></p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Setting up a custom SSB database location</h2>
<p><a href="https://scuttlebutt.nz">Secure Scuttlebutt</a> (SSB) is a peer-to-peer (p2p) social network -- akin to Facebook, but fully decentralized and owned by noone.  Connecting to the SSB network requires a client -- for example, <a href="https://github.com/ssbc/patchwork">Patchwork</a>.</p>
<p>One feature of this p2p network is that you store all of your peer data (your posts, and posts from friends) on your local drive -- which is neat, because it means that all of your data since your last sync is available even if you're offline.</p>
<p>One related caveat is that this means storing a lot of data locally; so it's good to have options for where to store it.</p>
<p>By default, all of your SSB data is stored in your home directory (an obvious location in Linux-based systems; not sure where the default is in Windows / Mac), in a directory called '.ssb'.</p>
<p>If you'd like to store it elsewhere, you can invoke a local installation of Patchwork (at least installations installed via npm) like so:</p>
<pre><code>npm start -- --path ~/Documents/myssb/.ssb
</code></pre>
<p>where in this case '~/Documenst/myssb/.ssb' is your custom (SSB) data directory location (could be external USB drive) for your '.ssb' folder. Seems to work!</p>
<p>Credit for this method goes to an online discussion thread <a href="https://github.com/ssbc/patchwork/issues/822">here</a>.</p>
<p>(To make this easier to invoke on a regular basis, I've posted a <a href="https://gist.github.com/dwblair/951df80d31d2940e55db70b7fd99e5fe">gist</a> with the startup script I use.)</p>
<h2>Dependencies for Patchwork on Ubuntu / Linux-based systems</h2>
<p>Note: I found a hiccup when trying to install Patchwork via npm on my Ubuntu system via 'npm install'.  It was solved by first installing these dependencies:</p>
<pre><code>sudo apt install libx11-dev libxkbfile-dev
</code></pre>
<h2>Further Resources / Links</h2>
<ul>
<li><a href="https://scuttlebutt.nz/">Secure Scuttlebutt</a> -- main site for the p2p networking protocol</li>
<li><a href="https://github.com/ssbc/ssb-server/wiki/pub-servers">Secure Scuttlebutt Pub Servers</a> -- list of servers you can join with a Secure Scuttlebutt 'client'</li>
<li><a href="https://github.com/ssbc/patchwork">Patchwork</a> -- a 'client' for Secure Scuttlebutt</li>
</ul>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><p>Collecting some tools I'm finding for estimating line-of-sight locations based on topography. Will annotate further as I learn more.</p>
<h2>Ubiquiti AirLink Signal Strength Mapping Tool</h2>
<p><a href="https://link.ui.com/#"><img src="/img/signal_strength/fresnel.png" alt="airlink"></a></p>
<p>The <a href="https://link.ui.com/#">AirLink tool</a> looks really promising!  Its calculations are tailored towards Ubiquiti products; but it will display the height profile and a visualization of the Fresnel zone between any two given points -- which might be really useful for estimating radio signal strength in general for radios (like LoRa) that are heavily dependent on line-of-sight connections.</p>
<h2>Heywhatsthat</h2>
<p><a href="https://www.heywhatsthat.com/"><img src="/img/signal_strength/hey.png" alt="hey"></a></p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Sparkfun SAMD21 breakout</h2>
<p>Experimenting with the <a href="https://www.sparkfun.com/products/13664">Sparkfun SAMD21 Mini Breakout</a>.
By powering it directly on the 3V line, we avoid the regulator. Was able to achieve 0.03 mA sleep current. Next test will be to put an RFM95 LoRa module in the mix.</p>
<p><img src="/img/proto1/spark_power.png" alt="sparkpower"></p>
<p><img src="/img/proto1/current.jpg" alt="current"></p>
<h2>Adafruit Feather</h2>
<p>Have only been able to achieve 0.2 mA sleep current on this. Somehow disabling the voltage regulator by pulling EN to ground, and powering the device on the 3V line, results in even higher sleep currents.</p>
<p><strong>Update 15 Sep 2020</strong>. Using <a href="https://gist.github.com/dwblair/b69a20dcf87314348bac970db574a723">this code</a> -- on a Feather M0 LoRa without any sensors attached -- was able to get down to 0.09 mA (90 uA). This isn't so far away from what one might expect for the AP2112K LDO used on the Feather (~ 60 uA), plus the M0 itself in standby sleep mode (~ 10 uA), plus the RFM95 radio in sleep mode (a few uA, I believe). Next steps: test sleep current with common sensors, with GPS, etc.</p>
<p><img src="/img/radio.jpg" alt="radio"></p>
<h2>Arm Programming</h2>
<p>Nice <a href="https://learn.sparkfun.com/tutorials/arm-programming?_ga=2.31674685.2071070740.1598130081-351514117.1580570302">notes on ARM programming</a> from Sparkfun.</p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><p>This weekend we used the <a href="https://github.com/meshtastic/Meshtastic-python">Meshtastic Python API</a> to perform some basic range tests of the <a href="https://www.meshtastic.org/">Meshtastic</a> LoRa mesh networking communications system, around the lake at Newfound Lake in Bristol, NH.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111617074_HDR.jpg"> <img src="/img/newfound/IMG_20200830_111617074_HDR.jpg" alt="IMG_20200830_111617074_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://community.hiveeyes.org/t/heltec-wifi-lora-32/3125">Heltec</a> widget set up as a automated <a href="https://www.meshtastic.org/">Meshtastic</a> LoRa mesh 'base station' node in a cabin on a lake. It's run by a <a href="https://github.com/meshtastic/Meshtastic-python">Mesthastic-python</a> script that replies to any messages sent to it with the SNR of the incoming message.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/locations.png"> <img src="/img/newfound/locations.png" alt="locations.png"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">The locations of various nodes in this experiment. With respect to the <strong>base station</strong> node, the <strong>kayak</strong> node is in a landscape-induced 'radio shadow' (the coast has steep hillsides), so that the only viable LoRa radio path from base station to kayak is via the <strong>relay</strong> node.</td>
</tr>
</tbody>
</table>
<h2>Background</h2>
<p>The goal was to test ‘hop’ dynamics with a system of 3 Meshtastic nodes, by first setting up a ‘base station sender’ and a ‘target receiver’ on opposite sides of a hill that blocks direct LoRa transmission; and then placing a ‘relay’ node on the ‘corner’ of that hill, so that messages might ‘hop’ around it.</p>
<p>The ‘sender’ was located in a cabin on a lake, and was controlled by Meshtastic-python, using a script (linked to in the above post) that would ‘reply’ to received messages with the SNR of the incoming message. The idea was that from the field I could send messages from my ‘end node’ (controlled via the Android app), and if the ‘relay’ node was able to relay my message via a ‘hop’ to the ‘base station sender’, I might ultimately get a reply relayed back to me at the end node.</p>
<p>I was able to nicely communicate among all the nodes directly; but in my quick test wasn’t able to accomplish a ‘hop’. Not yet sure why, but my test was a bit goofy and rushed, so I might have been doing something dumb. The ‘hop_limit’ parameter seems to have been set to ‘1’ – which should allow a single hop beyond the immediately adjacent nodes, from what I understand ... need to dig in further.</p>
<p>Below are some hastily-assembled data and scripts; will hope to organize this into a narrative account ASAP.</p>
<h2>Example Mesthastic-Python script</h2>
<p>A link to some of the Meshtastic-Python scripts we played with is <a href="https://github.com/edgecollective/meshtastic-python-experiments">here</a>.</p>
<pre><code class="language-python">import meshtastic
import time
from pubsub import pub

def onReceive(packet): # called when a packet arrives
    print(f&quot;Received: {packet}&quot;)
    if packet['decoded']['data'] is not None:
        msg = packet['decoded']['data']['text']
        rxSnr = packet['rxSnr']
        hopLimit = packet['hopLimit']
        print(f&quot;message: {msg}&quot;)
        reply=&quot;got msg \'{}\' with rxSnr: {} and hopLimit: {}&quot;.format(msg,rxSnr,hopLimit)
        print(&quot;Sending reply: &quot;,reply)
        interface.sendText(reply)

def onConnection(): # called when we (re)connect to the radio
    # defaults to broadcast, specify a destination ID if you wish
    interface.sendText(&quot;hello mesh&quot;)

pub.subscribe(onReceive, &quot;meshtastic.receive&quot;)
pub.subscribe(onConnection, &quot;meshtastic.connection.established&quot;)
interface = meshtastic.StreamInterface()
</code></pre>
<h2>Example Mesthastic-Python script output</h2>
<blockquote>
<p>Received: {'from': 3520888364, 'to': 4294967295, 'decoded': {'data': {'typ': 'CLEAR_TEXT', 'payload': 'dGVzdDc=', 'text': 'test7'}}, 'id': 2204634416, 'rxSnr': 3.0, 'hopLimit': 1, 'fromId': None, 'toId': '^all'}</p>
</blockquote>
<blockquote>
<p>message: test7</p>
</blockquote>
<blockquote>
<p>Sending reply:  got msg 'test7' with rxSnr: 3.0 and hopLimit: 1</p>
</blockquote>
<hr>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-123404.png"> <img src="/img/newfound/screen/Screenshot_20200830-123404.png" alt="Screenshot_20200830-123404"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-121357.png"> <img src="/img/newfound/screen/Screenshot_20200830-121357.png" alt="Screenshot_20200830-121357"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-123413.png"> <img src="/img/newfound/screen/Screenshot_20200830-123413.png" alt="Screenshot_20200830-123413"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-112105.png"> <img src="/img/newfound/screen/Screenshot_20200830-112105.png" alt="Screenshot_20200830-112105"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-124655.png"> <img src="/img/newfound/screen/Screenshot_20200830-124655.png" alt="Screenshot_20200830-124655"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-115555.png"> <img src="/img/newfound/screen/Screenshot_20200830-115555.png" alt="Screenshot_20200830-115555"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-121245.png"> <img src="/img/newfound/screen/Screenshot_20200830-121245.png" alt="Screenshot_20200830-121245"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-122047.png"> <img src="/img/newfound/screen/Screenshot_20200830-122047.png" alt="Screenshot_20200830-122047"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/screen/Screenshot_20200830-115714.png"> <img src="/img/newfound/screen/Screenshot_20200830-115714.png" alt="Screenshot_20200830-115714"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114603940.jpg"> <img src="/img/newfound/IMG_20200830_114603940.jpg" alt="IMG_20200830_114603940"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114936175_HDR.jpg"> <img src="/img/newfound/IMG_20200830_114936175_HDR.jpg" alt="IMG_20200830_114936175_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_120847462.jpg"> <img src="/img/newfound/IMG_20200830_120847462.jpg" alt="IMG_20200830_120847462"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_115532279.jpg"> <img src="/img/newfound/IMG_20200830_115532279.jpg" alt="IMG_20200830_115532279"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114310446_HDR.jpg"> <img src="/img/newfound/IMG_20200830_114310446_HDR.jpg" alt="IMG_20200830_114310446_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111650561.jpg"> <img src="/img/newfound/IMG_20200830_111650561.jpg" alt="IMG_20200830_111650561"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_122019615.jpg"> <img src="/img/newfound/IMG_20200830_122019615.jpg" alt="IMG_20200830_122019615"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_120908720.jpg"> <img src="/img/newfound/IMG_20200830_120908720.jpg" alt="IMG_20200830_120908720"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_130845706.jpg"> <img src="/img/newfound/IMG_20200830_130845706.jpg" alt="IMG_20200830_130845706"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_115540242.jpg"> <img src="/img/newfound/IMG_20200830_115540242.jpg" alt="IMG_20200830_115540242"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_120856393.jpg"> <img src="/img/newfound/IMG_20200830_120856393.jpg" alt="IMG_20200830_120856393"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_122032159.jpg"> <img src="/img/newfound/IMG_20200830_122032159.jpg" alt="IMG_20200830_122032159"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_122022494.jpg"> <img src="/img/newfound/IMG_20200830_122022494.jpg" alt="IMG_20200830_122022494"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_130853240.jpg"> <img src="/img/newfound/IMG_20200830_130853240.jpg" alt="IMG_20200830_130853240"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111632368.jpg"> <img src="/img/newfound/IMG_20200830_111632368.jpg" alt="IMG_20200830_111632368"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114323793.jpg"> <img src="/img/newfound/IMG_20200830_114323793.jpg" alt="IMG_20200830_114323793"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_121654604.jpg"> <img src="/img/newfound/IMG_20200830_121654604.jpg" alt="IMG_20200830_121654604"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_122318035.jpg"> <img src="/img/newfound/IMG_20200830_122318035.jpg" alt="IMG_20200830_122318035"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111611868_HDR.jpg"> <img src="/img/newfound/IMG_20200830_111611868_HDR.jpg" alt="IMG_20200830_111611868_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111400570.jpg"> <img src="/img/newfound/IMG_20200830_111400570.jpg" alt="IMG_20200830_111400570"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111624205.jpg"> <img src="/img/newfound/IMG_20200830_111624205.jpg" alt="IMG_20200830_111624205"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_123023686.jpg"> <img src="/img/newfound/IMG_20200830_123023686.jpg" alt="IMG_20200830_123023686"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_115528816_HDR.jpg"> <img src="/img/newfound/IMG_20200830_115528816_HDR.jpg" alt="IMG_20200830_115528816_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114804035.jpg"> <img src="/img/newfound/IMG_20200830_114804035.jpg" alt="IMG_20200830_114804035"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_110618746.jpg"> <img src="/img/newfound/IMG_20200830_110618746.jpg" alt="IMG_20200830_110618746"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_122026884_HDR.jpg"> <img src="/img/newfound/IMG_20200830_122026884_HDR.jpg" alt="IMG_20200830_122026884_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_130840593.jpg"> <img src="/img/newfound/IMG_20200830_130840593.jpg" alt="IMG_20200830_130840593"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_115535009.jpg"> <img src="/img/newfound/IMG_20200830_115535009.jpg" alt="IMG_20200830_115535009"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_111644049.jpg"> <img src="/img/newfound/IMG_20200830_111644049.jpg" alt="IMG_20200830_111644049"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_112506116.jpg"> <img src="/img/newfound/IMG_20200830_112506116.jpg" alt="IMG_20200830_112506116"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114553112_HDR.jpg"> <img src="/img/newfound/IMG_20200830_114553112_HDR.jpg" alt="IMG_20200830_114553112_HDR"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_120902450.jpg"> <img src="/img/newfound/IMG_20200830_120902450.jpg" alt="IMG_20200830_120902450"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/IMG_20200830_114338715.jpg"> <img src="/img/newfound/IMG_20200830_114338715.jpg" alt="IMG_20200830_114338715"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/newfound/arrival.jpg"> <img src="/img/newfound/arrival.jpg" alt="arrival.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>First Build of the Mothbot</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3588DGfwW04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/parts.jpg"> <img src="/img/mothbot/parts.jpg" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2>First Build Notes / Revision Ideas</h2>
<ul>
<li>Should we break out a 0.1&quot; i2c header, compatible with an SSD1306 display?  Maybe that's overkill for this project ...</li>
<li>The footprints for the resistors should be longer</li>
<li>soldermask on the antenna hole -- no good -- need to use another approach for making that hole</li>
<li>add pinout for the higher-voltage DC-DC?  maybe it feeds directly into the 3.3V LDO, too ... or can add jumpers</li>
<li>radio configuration where there's a relay that is constantly 'on' on top of a pole ... powered by 12V bat ... 12V bat being the go-to off-grid battery ...</li>
<li>reorient the power VIN + GND so that the cable will trail / orient towards the ground allowing a vertical antenna? add a mechanical relief location?</li>
<li><strong>BIG</strong> -- caps on power circuit should be 1uF.  Pin order messed up on MCP1700.</li>
<li>soldering the RFM95 -- really need to 'flood' the casselated pins in order for them to be connected properly -- would be good to have a diagnostic</li>
</ul>
<h2>KiCAD notes</h2>
<h3>Custom footprint as logo in KiCAD</h3>
<p>Use the 'Bitmap to component converter' in the main KiCad window (the bitmappy-looking 'a' in the below screenshot) to convert a bitmap to a footprint.  Then you can import this footprint directly to the PCB layout (no need to have an associated symbol), as a logo.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/converter.png"> <img src="/img/mothbot/converter.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Screenshot highlighting the 'bitmap to component converter'</td>
</tr>
</tbody>
</table>
<h3>Design Rules / Templates for OSHPark</h3>
<p><a href="https://docs.oshpark.com/design-tools/kicad/kicad-design-rules/">This guide</a> has some nice info.</p>
<h2>Reference for QWIIC connector</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/qwiic.png"> <img src="/img/mothbot/qwiic.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sparkfun 'QWIIC' I2C Connector</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/qwiic_board.png"> <img src="/img/mothbot/qwiic_board.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sparkfun 'QWIIC' I2C Connector</td>
</tr>
</tbody>
</table>
<p><a href="https://www.sparkfun.com/qwiic">Sparkfun QWIIC reference</a></p>
<p><a href="https://www.adafruit.com/product/4208">JST SH 4 Pin Connector</a></p>
<p><a href="https://www.adafruit.com/product/4210">Adafruit reference for JST SH 4 Pin QWIIC Pin Ordering</a></p>
<h2>Adding a reset button</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/reset_button.png"> <img src="/img/mothbot/reset_button.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Footprint for KMR2 pushbutton</td>
</tr>
</tbody>
</table>
<h2>Adding a DC-DC converter footprint</h2>
<p><a href="https://www.adafruit.com/product/1065">TSR12450 Converter</a> -- 5V output</p>
<p><a href="https://www.adafruit.com/product/1066">TSR12433 Converter</a> -- 3.3V output</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/dc_dc.png"> <img src="/img/mothbot/dc_dc.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Pinout for DC-DC</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/dcdc_bottom.png"> <img src="/img/mothbot/dcdc_bottom.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Footprint for DC-DC</td>
</tr>
</tbody>
</table>
<h2>Sensor notes</h2>
<h3>HC-SR04</h3>
<p><a href="https://www.adafruit.com/product/3942">Adafruit page</a></p>
<h3>SHT10</h3>
<p><a href="https://www.adafruit.com/product/1298">Adafruit page</a></p>
<h3>AM2315</h3>
<p><a href="https://github.com/adafruit/Adafruit_AM2315">Adafruit library</a></p>
<h3>Arduino Libraries</h3>
<p>Adafruit tutorail on installing Arduino libraries <a href="https://learn.adafruit.com/adafruit-all-about-arduino-libraries-install-use">here</a>.</p>
<h2>Version 1.0 Notes</h2>
<p>Made explicit i2c header that will allow for display.  But this means that certain i2c sensors are no longer useful via screw terminal.  But, added a 'qwiic' connector for i2c ... so maybe what we do is to make a qwiic adapter for AM2315 (i2c version).</p>
<p>Might need to change screw terminal size to 5mm, as they're far easier to source, it seems ...</p>
<p>Consider placing mounting holes at proper separation for 3XAA battery holder mounting holes ...</p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><p>We used some Arduino-based devices to demonstrate the <a href="https://www.airspayce.com/mikem/arduino/RadioHead/classRHMesh.html">mesh functionality</a> of the <a href="https://www.airspayce.com/mikem/arduino/RadioHead">Radiohead library</a>, a common radio library for LoRa radio devices.</p>
<p>Our starting point was the <a href="https://github.com/nootropicdesign/lora-mesh">code</a> from a <a href="https://nootropicdesign.com/projectlab/2018/10/20/lora-mesh-networking/">nootropic design blog post</a>. <a href="https://github.com/edgecollective/lora-mesh/tree/master/gpsexpt/exp3">Our version</a> adds GPS funcitonality, using some inexpensive GPS modules and some Adafruit Feather LoRa boards.</p>
<h2>Trial data</h2>
<p>In our first trial, we deployed three nodes at a residence in Lincoln, MA USA, as depicted in <strong>Fig 1</strong> below.  Node #1 (blue) is stationary, and connected to a laptop which is recording any data received by Node #1 (via a Python script).  Nodes #2 (red) and #3 (green) are mobile, and equipped with GPS; every few seconds they make a GPS measurement, and attempt to send their latitude and longitude back to Node #1.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="https://edgecollective.io/lora-mesh/gpsexpt/exp3/plotting/"> <img src="/img/lincoln/mesh.png" alt="mesh"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 1</strong>: Snapshot from an <a href="https://edgecollective.io/lora-mesh/gpsexpt/exp3/plotting/">animated depiction</a> of our first mesh networking test. The blue dot is Node #1 (stationary); Nodes #2 (green) and #3 (red) both attempt to send their GPS coordinates back to Node #1 every few seconds.  In this snapshot we see a situation where Node #2 traveled too far from Node #1 to reach it directly, and needed to relay its data via Node #2.</td>
</tr>
</tbody>
</table>
<p>What you can see in the <a href="https://edgecollective.io/lora-mesh/gpsexpt/exp3/plotting/">animation of the trial data</a> is the following:</p>
<ul>
<li>During the first part of the journey, Nodes #2 and #3 are able to send their data directly back to Node #1, as they are easily within range.</li>
<li>At some point, we found that lost the connection to Node #1 due to topography / obstructions; so we backtracked a bit to where we still had a good signal, and dropped off Node #3 by the side of the road.</li>
<li>We then continued to walk down the path with Node #2.</li>
<li>At various points, Node #2 loses its connection to Node #1, and re-routes (according to the Radiohead mesh algorithm) its messages via Node #3.</li>
</ul>
<p>You can also observe that at some point in our journey -- with Node #2, walking away from Node #1 -- we regain our connection to Node #1 (likely because we went up a hill, and regained line-of-sight).  We believe that the Radiohead algorithm will simply stick with whatever route was most recently successful until it fails; so perhaps this means that when we see Node #2 and Node #3 connecting, the connection between Node #2 and Node #3 must have dropped, prior. will look into this.</p>
<h2>Trial Pics</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/lincoln/snaps//two_nodes.jpg"> <img src="/img/lincoln/snaps//two_nodes.jpg" alt="two_nodes"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Node 2 (left) and Node 3 (right) before the field test.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/lincoln/snaps//node_2.jpg"> <img src="/img/lincoln/snaps//node_2.jpg" alt="node_2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Node 2 -- the 'red' node in the animation above -- that traveled the furthest distance away from Node 1.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/lincoln/snaps//node_2_a.jpg"> <img src="/img/lincoln/snaps//node_2_a.jpg" alt="node_2_a"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Node 2 on the road ...</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/lincoln/snaps//node_3.jpg"> <img src="/img/lincoln/snaps//node_3.jpg" alt="node_3"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Node 3, placed in on a stone wall to serve as a 'relay node' between Node 1 and Node 2.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/lincoln/snaps//node_3_closeup.jpg"> <img src="/img/lincoln/snaps//node_3_closeup.jpg" alt="node_3_closeup"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Closeup of Node 3.</td>
</tr>
</tbody>
</table>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Arduino IDE Setup</h2>
<p>Board Manager URL for ESP32:</p>
<p><code>https://dl.espressif.com/dl/package_esp32_index.json</code></p>
<p>Board Manager URL for Feather M0 LoRa:</p>
<p><code>https://adafruit.github.io/arduino-board-index/package_adafruit_index.json</code></p>
<h2>Guides</h2>
<p><a href="https://robotzero.one/heltec-wifi-kit-32/">Robotzero</a></p>
<p>Basically need to just load this config file in 'Additional Board Manager URLs' field in Preferences in Arduino IDE:</p>
<p><code>https://dl.espressif.com/dl/package_esp32_index.json</code></p>
<p>Then can select Heltec WiFi Lora (V2) (the board we're using).</p>
<p>WiFi scan worked.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/heltec/wifi_scan.png"> <img src="/img/heltec/wifi_scan.png" alt="wifi scan"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Initial wifi scan test.</td>
</tr>
</tbody>
</table>
<h2>Display Library</h2>
<p><a href="https://github.com/olikraus/u8g2">U8g2 library</a> for Arduino covers a wide range of common displays.</p>
<p><a href="https://gist.github.com/dwblair/d74bb01fbd3514ffd6b5eb5d9b66ab88">Test code</a> that will scan wifi and display the results on the screen.</p>
<h2>Main Heltec Documentation</h2>
<p><a href="https://heltec.org/project/wifi-lora-32/">Heltec Wifi Lora 32</a></p>
<h2>Coding and Setup Debugging ...</h2>
<p><a href="https://www.instructables.com/id/Introduction-to-ESP32-WiFi-LoRa/">Instructable</a> that has a nice set of diagrams of pinouts</p>
<p><a href="https://github.com/HelTecAutomation/Heltec_ESP32">Heltec Library</a></p>
<p><a href="https://github.com/Heltec-Aaron-Lee/WiFi_Kit_series">Main github reference for Heltec devices -- includes KiCad file for device</a></p>
<p><a href="http://community.heltec.cn/t/heltec-wifi-lora-32-v2-send-receive/160">Heltec WiFi LoRa send / receive</a></p>
<p><a href="http://community.heltec.cn/t/ping-pong-test-between-cubecell-dev-board-and-wifi-lora-32-v2/508/7">Heltec syncword issue</a></p>
<p><a href="https://robotzero.one/heltec-wifi-lora-32/">Robot Zero One LoRa receiver demo</a></p>
<p>They suggest using <a href="https://github.com/sandeepmistry/arduino-LoRa">this LoRa library</a>.</p>
<h2>Working LoRa Example</h2>
<p>Follow <a href="https://robotzero.one/heltec-wifi-lora-32/">Robot Zero One LoRa receiver demo</a>;</p>
<p>use <a href="https://github.com/sandeepmistry/arduino-LoRa">this LoRa library</a>;</p>
<p>And <a href="https://gist.github.com/dwblair/cfe9bfb895d4ad72d88ed91fb76ded47">this example</a>.</p>
<p><strong>Receive and display</strong>. Can get it posted on the display using <a href="https://gist.github.com/dwblair/9da853fb274c184f89f3f14123b9e032">this example</a> with <a href="https://github.com/olikraus/u8g2">U8g2 display library</a> -- basically works.</p>
<h2>Radiohead Example</h2>
<p><a href="https://gist.github.com/dwblair/e6626567ff14cec6e29db35b8eb985ed">Basic RFM95 Receive</a> code for Heltec.  Works.</p>
<h2>Low Power sleep</h2>
<p><a href="https://github.com/Heltec-Aaron-Lee/WiFi_Kit_series/issues/6">Discussion of entering low power sleep mode</a></p>
<h2>HTTP GET AND POST</h2>
<p>Tutorial <a href="https://randomnerdtutorials.com/esp32-http-get-post-arduino/">here</a>.</p>
<p>Working code to do basic JSON post to FarmOS <a href="https://gist.github.com/dwblair/c1411750491ef2120d01ca661dbcd747">here</a>.</p>
<p>ArduinoJSON SerializeJSON <a href="https://arduinojson.org/v6/api/json/serializejson/">documentation</a>.</p>
<h2>HTTP JSON POST TO FARMOS</h2>
<p>Using loop-updated variables, code is <a href="https://gist.github.com/dwblair/731c806170a11bfc536c32d126559495">here</a>.</p>
<h2>HELTEC WIFI LORA POST TO FARMOS</h2>
<p>Using dummy variables, not yet parsing incoming radio, code is <a href="https://gist.github.com/dwblair/895fdbe3cbb5f5f1c43025230a8a5f10">here</a></p>
<h2>Github Repo</h2>
<p>Feather sends JSON data; Heltec receives, parses, posts to FarmOS; code is <a href="https://github.com/edgecollective/heltec-32-lora-v2-farmos/tree/master/ver1">here</a>.</p>
<h2>1-wire temp sensor on remote</h2>
<p><a href="https://lastminuteengineers.com/ds18b20-arduino-tutorial/">Tutorial</a></p>
<h2>Sleep Modes for ESP32</h2>
<p>Some nice notes <a href="https://lastminuteengineers.com/esp32-sleep-modes-power-consumption/#:~:text=ESP32%20Sleep%20mode%20is%20a,it%20to%20retain%20its%20data.">here</a></p>
<p>Deep sleep <a href="https://lastminuteengineers.com/esp32-deep-sleep-wakeup-sources/">example code</a></p>
<p>Able to get about 2 mA in deep sleep using Heltec. ...</p>
<p>.. then turned off lora radio and got 1 mA.</p>
<p>gist of the code to do this is <a href="https://gist.github.com/dwblair/5bd69024c8536780fa1e3bf835f1d8fb">here</a></p>
<p>Further discussion of low power modes <a href="https://www.reddit.com/r/esp32/comments/gx8fxk/hibernatepower_off/">here</a>.</p>
<h2>ESP32 Data logging</h2>
<p><a href="https://randomnerdtutorials.com/esp32-data-logging-temperature-to-microsd-card/">Nice tutorial here</a></p>
<h2>Single-channel gateway guides</h2>
<p><a href="https://github.com/things4u/ESP-1ch-Gateway">Using ESP8266</a></p>
<p><a href="https://learn.sparkfun.com/tutorials/esp32-lora-1-ch-gateway-lorawan-and-the-things-network/all">From Sparkfun</a></p>
<p><a href="https://appcodelabs.com/introduction-to-iot-building-a-budget-single-channel-lora-gateway">Appcodelabs using MQTT</a></p>
<p><a href="https://www.cnx-software.com/2018/08/21/how-to-make-cheap-single-channel-gateway-lora-esp32-board/">From CNX Software</a> -- looks like they use dozens of nodes here.</p>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><p>Below is a development notebook for constructing a DIY CO2 monitor.</p>
<p>Click <a href="#gatewaysetup">here</a> to jump to the latest remote CO2 node + gateway setup.</p>
<h2>CO2METER.COM K30</h2>
<p><a href="https://www.co2meter.com/products/k-30-co2-sensor-module">Online description of K30</a></p>
<p><a href="http://co2meters.com/Documentation/Datasheets/DS_SE_0118_CM_0024_Revised9%20(1).pdf">K30 Datasheet</a></p>
<p>Needs 5V power minimum.</p>
<p>Logic levels are 3.3V</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/fig2.png"> <img src="/img/co2/fig2.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Figure 2 from the <a href="http://co2meters.com/Documentation/Datasheets/DS_SE_0118_CM_0024_Revised9%20(1).pdf">K30 datasheet</a>.</td>
</tr>
</tbody>
</table>
<ul>
<li>'G0' -- GND</li>
<li>'G+' -- Voltage input (5V to 9V)</li>
<li>'TxD, RxD' -- UART</li>
<li>'OUT1' -- Analog output (alternative way of getting the data)</li>
</ul>
<p>Datasheet says: should avoid connecting analog and digital ground pins externally in order to avoid ground loops</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/analog_outputs.png"> <img src="/img/co2/analog_outputs.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Analog outputs.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/calibration.png"> <img src="/img/co2/calibration.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Calibration.</td>
</tr>
</tbody>
</table>
<h2>Connecting to an Arduino</h2>
<h3>Via I2C</h3>
<p><a href="http://www.co2meters.com/Documentation/AppNotes/AN102-K30-Sensor-Arduino-I2C.pdf">Connecting a K30 to an Arduino via I2C</a></p>
<p>This suggests using 6 to 9V input. (Might be good to upgrade the spec on the MCP1702 voltage reg so we can take &gt; 6V input on the Mothbot).  Needs to be able to provide 500mA.  So: direct from battery power is likely best.</p>
<h3>Via UART</h3>
<p><a href="http://www.co2meters.com/Documentation/AppNotes/AN126-K3x-sensor-arduino-uart.pdf">Connecting a K30 to an Arduino via UART</a></p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/uart_closeup.png"> <img src="/img/co2/uart_closeup.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">UART connection.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/first_readings.png"> <img src="/img/co2/first_readings.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">First readings.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/breath_test.png"> <img src="/img/co2/breath_test.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Blowing on the sensor and then letting it recover.</td>
</tr>
</tbody>
</table>
<p>Edge Collective copy of the library for UART connection is <a href="https://github.com/edgecollective/co2-kseries">here</a> (replica of that provided by CO2 Monitor <a href="http://www.co2meters.com/Documentation/AppNotes/AN126-K3x-sensor-arduino-uart.zip">here</a>).</p>
<h2>SSD1306 Display</h2>
<p>Guide <a href="https://randomnerdtutorials.com/guide-for-oled-display-with-arduino/">here</a> for hookup to Arduino UNO.</p>
<h2>UART + SSD1306 Display</h2>
<p>Example code <a href="https://gist.github.com/dwblair/310acc6f8dafa8f82af713200ceda577">here</a>.</p>
<h2><a name="gatewaysetup"></a> Remote LoRa CO2 Node and Heltec Gateway sending to FarmOS</h2>
<p>Using a <a href="https://edgecollective.io/posts/notes/mothbot/">Mothbot</a> to connect to the K30 sensor over UART and send via LoRa to a <a href="https://www.amazon.com/MakerFocus-Development-Bluetooth-0-96inch-Display/dp/B076MSLFC9">Heltec</a> Wifi-LoRa gateway, posting to <a href="https://edgecollective.farmos.net/farm/sensor/heltecone">FarmOS</a>.</p>
<p>Code for remote and gateway is <a href="https://github.com/edgecollective/co2-remote-and-gateway">here</a>.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/remote_v1.jpg"> <img src="/img/co2/remote_v1.jpg" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Mothbot remote node connected to K30 CO2 sensor.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/mothbo.jpg"> <img src="/img/co2/mothbo.jpg" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Closeup of Mothbot.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/k30.jpg"> <img src="/img/co2/k30.jpg" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Closeup of K30 CO2 sensor.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/heltec_gateway.jpg"> <img src="/img/co2/heltec_gateway.jpg" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Heltec Wifi-LoRa gateway</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/co2/farmos_graph.png"> <img src="/img/co2/farmos_graph.png" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Graphing on FarmOS</td>
</tr>
</tbody>
</table>
<h2>Misc</h2>
<p>Would be nice to develop useful ways of connecting to some standard hardware (e.g. Feathers, etc).</p>
<h2>CO2 and Greenhouses</h2>
<p><a href="https://www.greenhousegrower.com/production/monitoring-carbon-dioxide-in-the-greenhouse/">Article</a> on measuring CO2 in greenhouses:</p>
<blockquote>
<p>Until recently, the vast majority of growers in the U.S. did not measure CO2 or use it to enrich their greenhouses. However, during the winter, CO2 levels can quickly become limiting in unventilated greenhouses full of plants on cold and sunny days. Over the past 10 years, we have also seen greenhouse growers seal up their greenhouses in an effort to control their heating bills during the winter. Other growers, especially in northern latitudes, have invested in supplemental lighting because of the numerous benefits, from improved quality and yields to reduced production time. An apparent result of tightly sealing the greenhouse is increased humidity and condensation. A not-so-apparent result of reducing air infiltration is a reduction of CO2 levels within the greenhouse below ambient levels found outdoors.</p>
</blockquote>
</p>
      </div>
    </div>
  </div>

  <div class="post">
    <div class="project-contents">
      <div class="text">
        <h3>Note </h3>
        <p><h2>Temperature Measurement</h2>
<p><a href="https://learn.adafruit.com/adafruit-max31865-rtd-pt100-amplifier">RTD amp</a> breakout from Adafruit.</p>
<h2>Signal Sampling</h2>
<p><a href="https://www.ti.com/lit/an/sboa068/sboa068.pdf?ts=1601648370947&amp;ref_url=https%253A%252F%252Fwww.google.com%252F">Burr Brown App Note</a> on precision absolute value circuits.</p>
<h2>Signal generation</h2>
<p><a href="https://www.instructables.com/Arduino-Waveform-Generator/">Arduino Waveform Generator</a></p>
<h2>Prior Art Among Us</h2>
<p>Don's last version in January, based off Craig's 4pstat is <a href="https://gitlab.com/p-v-o-s/echem/4pstat/-/blob/4p-v1/kicad-pcb/pdf/4pstat.pdf">here</a></p>
<p>Craig's latest 4pstat is <a href="https://gitlab.com/p-v-o-s/echem/4pstat/-/blob/master/kicad-pcb/pdf/4pstat.pdf">here</a></p>
<p>Don's simplified 4 probe based on an earlier design is <a href="https://gitlab.com/p-v-o-s/echem/ec-4p/-/blob/master/v_0.1/four_probe.pdf">here</a></p>
<h2>Craig comments</h2>
<blockquote>
<p>What I found that seems to work well on the driven shield lines was to use some RC snubbers to ground after the 50 Ohm output resistor.  Values like 10 Ohm and 100nF give you a corner frequency of 160kHz - if your bandwidth is 10kHz that should likely work out.</p>
</blockquote>
<blockquote>
<p>Don, if you use my design, there are lots of mods needed to stop it from oscillating.</p>
</blockquote>
<blockquote>
<p>If you are doing a virtual ground, I suggest using the <a href="https://gitlab.com/p-v-o-s/echem/4pstat/-/issues/7#note_364944285">in-the-loop compensation circuit I got from AoE3</a></p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/intheloop.jpg"> <img src="/img/intheloop.jpg" alt="fig2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">In-the-loop compensation scheme suggested by Craig <a href="https://gitlab.com/p-v-o-s/echem/4pstat/-/issues/7#note_364944285">here</a>.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Actually I wonder if the corner frequency is actually 6X lower because of the added 50 Ohm resistor? If that is the case, it might be better to back off the capacitance a bit And what about output resistance from the opamp (Mike, I'm looking at you)? If that's like around 100 Ohm maybe we'd be smart using an even smaller cap. This could be why I did not make my intended bandwidth of 100kHz on the bodged up 4pstat.</p>
</blockquote>
<h2>Current Work</h2>
<p>As of 10-02-2020:</p>
<ul>
<li>use an OPA281 for the TIA (current measurement)</li>
<li>use an INA2331 for the INAMP (voltage measurement)</li>
<li>add the driven shield, snubs, and in-the-loop compensation as per Craig's design &amp; mods</li>
<li>use through-hole headers for any passives we might want to swap (avoiding the MUX chip for now) to simplify the board</li>
</ul>
<p>Don's current attempt at the above is <a href="https://gitlab.com/p-v-o-s/echem/ec-4p/-/blob/master/v_0.3/pdf/ec-4p.pdf">here</a>.</p>
</p>
      </div>
    </div>
  </div>

</div>
-->

  </body>
</html>
