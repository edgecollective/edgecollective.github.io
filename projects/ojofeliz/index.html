

<!-- feed it through our cssmin filter to minify -->
<style>
  body{font-family:sans-serif;margin:20px;font-size:small;width:90%;margin-right:auto;margin-left:auto;padding-top:15px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:small;margin-bottom:1px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding-right:20px}.post .post-contents{background:#f7f7f7;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}.post .text{height:200px;padding:20px}@media (max-width:680px){.post{width:100%}}body{font:15px/1.5 sans-serif;width:80%}.img-with-caption{font-size:15px;text-align:center;margin:20 0;background-color:F1F1F1;padding:10px}#pullout{text-align:center}#intro{max-width:700px;display:inline-block;text-align:left}#post-content{max-width:800px}#post-title{margin-bottom:1px;background-color:#eee;border:1px solid #999;display:block;padding:8px;width:max-content;font-size:40px;margin-right:40px;margin-bottom:5px}#profile_pic{float:right;margin:0 0 1em 1em}#main-title{line-height:1em;font-size:x-large;margin-bottom:.31em}h1{line-height:1em;font-size:30px;margin-bottom:.31em}h2{margin-bottom:1px;font-size:22px}h3{font-size:15px;margin-bottom:1px}ol,ul{max-width:650px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding:0 20px 20px 0}.contribute{width:100%;padding-top:10px}.post .post-contents{border-radius:10px;padding:20px 20px 10px 20px}.post .project-contents{background:#add8e6;border-radius:10px;padding:20px 20px 10px 20px}.post .project-updated{font-size:6px}.post .podcast-contents{background:#e9967a;border-radius:10px;padding:20px 20px 10px 20px}.post .note-contents{background:#e6e6fa;border-radius:10px;padding:20px 20px 10px 20px}.post .pedagogy-contents{background:#90ee90;border-radius:10px;padding:20px 20px 10px 20px}.post .talk-contents{background:pink;border-radius:10px;padding:20px 20px 10px 20px}.post .inter-contents{background:#add8e6;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}img{max-height:500px;max-width:100%}table{margin:30 auto 30 auto;padding:10px;text-align:left;border:1px solid #000}td{padding:10px;text-align:left;font-size:15}.post .text{min-height:250px;padding:5px}.post .inter-text{height:250px}audio{width:100%;height:30px}@media (max-width:1100px){.post{width:100%}table{width:100%}}.frame{height:300px;width:100%;white-space:nowrap;text-align:center;margin:1em 0}.helper{display:inline-block;height:100%;vertical-align:middle}.present_img{background:#3a6f9a;vertical-align:middle;max-height:300}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/img/edge_favicon.png" />
    <title>Water Storage Monitoring in New Mexico</title>
  </head>
  <body>

    <div id='post-content'>

  <h3><a href="/">Edge Collective</a></h3>
    <h1>Water Storage Monitoring in New Mexico</h1>
    <i>Developing an open source, satellite modem-based water level monitoring system with Grass Nomads LLC.</i>

        <!-- <h1>Water Storage Monitoring in New Mexico</h1> -->

  
  <h1>Background</h1>
<p><a href="/img/ojofeliz/ofr7.jpeg"><img src="/img/ojofeliz/ofr7.jpeg" alt=""></a></p>
<p><a href="https://www.grassnomads.com/">Grass Nomads, LLC</a> leases a 120,000 acre high elevation ranch in New Mexico, where they run a cow-calf operation with an extensive water system. Several key storage tanks in their system are the first indication of a leak or failure, and driving to them takes hours. Remote water monitoring would save them time, vehicle wear, and water -- and also enable them to run higher herd density and improve their range management.</p>
<!--
| [![](/img/ojofeliz/ofr_map.png)](/img/ojofeliz/ofr_map.png) |
|:--:|
|**Fig 1.** The Ojo Felix ranch, a 200 square mile lease, shwoing the location of the three key water storage tanks to be monitored -- 'Twin Towers', 'Casias', and 'Marsh Wells'. Not shown are planned pipelines to be installed in 2023.   |
-->
<p>In particular, there is an interest in collecting ongoing water level data from three key water storage tanks on the ranch is of particular interest: 'Twin Towers' (Fig. 1), 'Casias' (Fig 2), and 'Marsh Wells'.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/twintowers.jpeg"><img src="/img/ojofeliz/twintowers.jpeg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 1.</strong> The 'Twin Towers' water storage tank on Ojo Feliz Ranch, one of the tanks to be monitored.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/casias.png"><img src="/img/ojofeliz/casias.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 2.</strong> The 'Casias' water storage tank on Ojo Feliz Ranch, another of the tanks to be monitored.</td>
</tr>
</tbody>
</table>
<h1>Planned monitoring strategy</h1>
<p>Because of the remote location of the water storage tanks and uncertain cellular coverage, we have decided to develop a satellite modem-based monitoring system.  Currently, we are unsure as to whether the satellite modem (and accompanying solar panel) would best be situated directly on top / next to the storage tank, or whether a location 100+ feet away might better optimize solar energy and minimize obstacles to satellite coverage.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/system_overview.png"><img src="/img/ojofeliz/system_overview.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 3.</strong> The overall approach to monitoring the water storage tanks.</td>
</tr>
</tbody>
</table>
<p>We are therefore designing the system to include a 'low-power, remote radio (LoRa) depth sensor node', which will be situated on the tank, and relay its data to a 'LoRa-satellite-modem gateway' somewhere within radio range (Fig 3).</p>
<p>The satellite modem will then send water level data to an online database, allowing Grass Nomads LLC to access up-to-date water level over the internet or on their phones, anywhere they have access to internet or cellular service.</p>
<h1>Core hardware components for the design</h1>
<p>Except for the custom PCBs we will be designing, nearly every component of the system consists of off-the-shelf hardware, including the satellite modem (Fig 4), ultrasonic water sensor (Fig 5), and microcontroller + LoRa radio (Fig 6).</p>
<p>We've evaluated the <a href="https://docs.rockblock.rock7.com/docs/iridium-contract-costs">satellite modem data plan pricing</a>, and believe that if we send one water level update per day from each storage tank (with a message containing measurements at 4 hour intervals for the previous 24 hours), the associated cost of the satellite data service will be the same as or less than a comporable cellular data plan.</p>
<!--
| [![](/img/ojofeliz/ultrasonic_housing.jpg)](/img/ojofeliz/ultrasonic_housing.jpg) |
|:--:|
|**Fig 7.** Close-up of the housing for the ultrasonic water level sensor. |

-->
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/rockblock.jpg"><img src="/img/ojofeliz/rockblock.jpg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 4.</strong> The <a href="https://www.sparkfun.com/products/13745">Rockblock 9602 Satellite Modem</a>, available e.g. from Sparkfun for $300 USD</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/max7092.jpg"><img src="/img/ojofeliz/max7092.jpg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 5.</strong> The <a href="https://www.adafruit.com/product/1137">Maxbotix MB7092</a>, available e.g. from Adafruit for $100</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/feather_m0.jpg"><img src="/img/ojofeliz/feather_m0.jpg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 6.</strong> The <a href="https://www.adafruit.com/product/3178">Feather M0 LoRa microcontroller</a>, available e.g. from Adafruit for $35</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/adafruit_solar.jpg"><img src="/img/ojofeliz/adafruit_solar.jpg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 6.</strong> Image from Adafruit LLC depicting the <a href="https://www.adafruit.com/product/4755">solar charging circuit</a> ($15), we'll be using in our design, as well as a similar <a href="https://www.adafruit.com/product/2747">solar panel</a> ($80), and <a href="https://www.adafruit.com/product/353">6600 mAh lithium ion battery</a> ($25) to those we intend to deploy at Ojo Feliz.</td>
</tr>
</tbody>
</table>
<p>We'll be designing a simple, easy-to-solder through-hole PCB (printed circuit board) to integrate these components and allows them to be easily mounted inside a weatherproof enclosure, and connected to a solar panel, battery, and associated solar charging circuitry.</p>
<h1>Prior work</h1>
<p>At Edge Collective we have previously developed and worked with most of the non-satellite components of this system, collecting data from a solar-powered ultrasonic water level sensor (Fig 7) via local LoRa radio connection to a LoRa-wifi gateway, and sending it periodically to an online database (Fig 8).</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/chappy_proto.png"><img src="/img/ojofeliz/chappy_proto.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 7.</strong> A previous, LoRa-based ultrasonic water level sensor prototype built by Edge Collective.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/sonar_data.png"><img src="/img/ojofeliz/sonar_data.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 8.</strong> Data from an initial deployment of a LoRa-based ultrasonic sensor</td>
</tr>
</tbody>
</table>
<p>Another example of a version of the (open source) online database system we'd previously developed (in this case, used for chicken coop temperatures) is <a href="http://bayou.pvos.org/data/834ksnvaq3hn?plot_param=temperature_c">here</a>.</p>
<p>Edge Collective had also previously developed an [open source LoRa radio + satellite modem gateway] in a previous design (see Figs 9 and 10), which was designed to relay data from field sensor relay nodes in a very similar manner to the planned system for this project.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/quahog_schem.pdf"><img src="/img/ojofeliz/quahog_schem.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 9.</strong> Schematic for the 'Quahog', a wifi + LoRa + satellite gateway design by Edge Collective, which shares many features with the planned gateway for the Ojo Feliz project.  The precise microcontroller may differ, but is also likely to be wifi-enabled.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/quahog_plugged.jpeg"><img src="/img/ojofeliz/quahog_plugged.jpeg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 10.</strong> Previous Edge Collective gateway design, the 'Quahog', which incorporates satellite modem (left), as well LoRa radio and wifi-enabled microcontroller (right).</td>
</tr>
</tbody>
</table>
<p>Edge Collective had also designed a low-power, battery-powered LoRa relay node (Figs 11 and 12) and antenna inside an off-the-shelf weatherproof enclosure for a previous project involving an Acclima soil moisture sensor.  The design of that relay node has significant overlap with the relay node we intend to design for the ultrasonic relay node.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/acclima.JPG"><img src="/img/ojofeliz/acclima.JPG" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 11.</strong> A previous Edge Collective sensor LoRa relay design (right); in this case, for capturing data from an Acclima soil moisture sensor (left) and relaying data via LoRa to a LoRa-wifi gateway.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/relay_node.png"><img src="/img/ojofeliz/relay_node.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 12.</strong> Closeup of the Edge Collective LoRa relay node, showing the custom circuitboard, indicator LEDs, screw terminal connectors, and Feather LoRa microcontroller daughterboard.</td>
</tr>
</tbody>
</table>
<p>Recent Edge Collective projects have refined the process of designing easy-to-solder PCBs (printed circuit boards) that integrate off-the-shelf products into circuits that are ready to mounted in an enclosure (Fig 13).</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/relay_motherboard_closeup.png"><img src="/img/ojofeliz/relay_motherboard_closeup.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 13.</strong> A previous Edge Collective project that incorporated the Feather M0 LoRa microcontroller, SSD1306 display, and screw terminal connectors to external sensors, in a design very similar to that we'll be making for the Ojo Feliz remote water sensor project.</td>
</tr>
</tbody>
</table>
<p>Several Edge Collective projects have been deployed in the field for long-term, low-power monitoring projects using solar panels and off-the-shelf weatherproof enclosures -- including standard 'electrical conduit boxes' from Home Depot (Fig 14).</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/gateway_node.png"><img src="/img/ojofeliz/gateway_node.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 14.</strong> Enclosure setup for a previous Edge Collective field-based gateway project, demonstrating the use of weatherproof pass-throughs and solar panels on an off-the-shelf Home Depot electrical conduit box.</td>
</tr>
</tbody>
</table>
<p>Edge Collective has also developed <a href="http://bayou.pvos.org/">an open source, no-frills online database</a> with graphing functionality and the ability to download historical data as CSV or JSON files.  (For example involving data from an off-grid chicken coop, see Fig 15.)</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/bayou_chickens.png"><img src="/img/ojofeliz/bayou_chickens.png" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 15.</strong> Screen capture of graphical data for a data feed (in this case, data from an off-grid chicken coop LoRa-based temperature sensor) hosted on <a href="http://bayou.pvos.org/data/834ksnvaq3hn?plot_param=temperature_c">bayou.pvos.org</a>, Edge Collective's open source online database. The Ojo Feliz system will likely use Bayou, but could also be reprogrammed to use other online data storage options (e.g. storing data directly in a Google spreadsheet).</td>
</tr>
</tbody>
</table>
<h1>Current status</h1>
<p>We currently have a working breadboard prototype (Fig 16) of a satellite modem + ultrasonic water level device, which has successfully posted its data to an online database.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/ojofeliz/breadboard.jpeg"><img src="/img/ojofeliz/breadboard.jpeg" alt=""></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Fig 16.</strong> Breadboard prototype demonstrating integrated functionality of ultrasonic sensor, microcontroller, and satellite modem functionality.</td>
</tr>
</tbody>
</table>
<p>We have also developed a sensible encoding scheme so that water level data from the ultrasonic sensor, collected at 4 hour intervals over a 24 hour period, can be compressed and sent over a single satellite modem transmission once per day, significantly decreasing data plan costs.</p>
<p>Next steps include designing and producing a batch of integrative PCBs for these devices, optimizing the firmware for power, and adding in the 'LoRa relay' node circuitry if necessary.</p>
<h1>More images of Ojo Feliz Ranch</h1>
<p><a href="/img/ojofeliz/ofr1.jpeg"><img src="/img/ojofeliz/ofr1.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/ofr3.jpeg"><img src="/img/ojofeliz/ofr3.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/ofr4.jpeg"><img src="/img/ojofeliz/ofr4.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/ofr5.jpeg"><img src="/img/ojofeliz/ofr5.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/ofr6.jpeg"><img src="/img/ojofeliz/ofr6.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/ofr2.jpeg"><img src="/img/ojofeliz/ofr2.jpeg" alt=""></a></p>
<p><a href="/img/ojofeliz/horseback.jpeg"><img src="/img/ojofeliz/horseback.jpeg" alt=""></a></p>


    </div>
  </body>
</html>
