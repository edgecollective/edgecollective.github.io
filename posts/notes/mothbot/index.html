

<!-- feed it through our cssmin filter to minify -->
<style>
  body{font-family:sans-serif;margin:20px;font-size:small;width:90%;margin-right:auto;margin-left:auto;padding-top:15px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:small;margin-bottom:1px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding-right:20px}.post .post-contents{background:#f7f7f7;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}.post .text{height:200px;padding:20px}@media (max-width:680px){.post{width:100%}}body{font:13px/1.5 Verdana,Helvetica,Arial,sans-serif;width:80%}.img-with-caption{font-size:14px;text-align:center;margin:20 0;background-color:F1F1F1;padding:10px}#pullout{text-align:center}#intro{max-width:700px;display:inline-block;text-align:left}#post-content{max-width:800px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:medium;margin-bottom:1px}ol,ul{max-width:650px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding:0 20px 20px 0}.contribute{width:100%;padding-top:10px}.post .post-contents{border-radius:10px;padding:20px 20px 10px 20px}.post .project-contents{background:#add8e6;border-radius:10px;padding:20px 20px 10px 20px}.post .podcast-contents{background:#e9967a;border-radius:10px;padding:20px 20px 10px 20px}.post .note-contents{background:#e6e6fa;border-radius:10px;padding:20px 20px 10px 20px}.post .pedagogy-contents{background:#90ee90;border-radius:10px;padding:20px 20px 10px 20px}.post .talk-contents{background:pink;border-radius:10px;padding:20px 20px 10px 20px}.post .inter-contents{background:#add8e6;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}img{max-height:500px;max-width:100%}table{margin:30 auto 30 auto;padding:10px;width:80%;text-align:left;border:1px solid #000}td{padding:10px;text-align:left;font-size:12}.post .text{min-height:250px;padding:5px}.post .inter-text{height:250px}audio{width:100%;height:30px}@media (max-width:1100px){.post{width:100%}table{width:100%}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/img/edge_favicon.png" />
    <title>Edge Collective</title>
  </head>
  <body>

    <div id='post-content'>

  <a href="/">Edge Collective</a>
        <h1>Mothbot Prototyping</h1>

  
  <h2>Table of Contents</h2>
<ul>
<li><a href="#mothbot_ver3_parts">Mothbot Version 3 Parts List</a></li>
</ul>
<h2>TODO</h2>
<ul>
<li>Cite the JeeLab post on running the 328p at 3.3V and 16MHz, using UNO bootloader</li>
</ul>
<h2>Background</h2>
<p>Mothbot is based on the initial JeeNode design by JeeLabs.</p>
<p>It's similar to many 'minimal Arduino' designs.  For example:</p>
<ul>
<li>Jameco 'build your own arduino' <a href="https://www.jameco.com/webapp/wcs/stores/servlet/Product_10001_10001_2151259_-1">kit</a></li>
<li>associated <a href="https://www.jameco.com/jameco/workshop/jamecobuilds/arduinocircuit.html">tutorial</a></li>
</ul>
<h2>Burning a bootloader on a 328P using a 328P</h2>
<p>Guide <a href="http://www.vwlowen.co.uk/arduino/bootloader/page2.htm">here</a></p>
<h2>First Build of the Mothbot</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3588DGfwW04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/parts.jpg"> <img src="/img/mothbot/parts.jpg" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
<h2>First Build Notes / Revision Ideas</h2>
<ul>
<li>Should we break out a 0.1&quot; i2c header, compatible with an SSD1306 display?  Maybe that's overkill for this project ...</li>
<li>The footprints for the resistors should be longer</li>
<li>soldermask on the antenna hole -- no good -- need to use another approach for making that hole</li>
<li>add pinout for the higher-voltage DC-DC?  maybe it feeds directly into the 3.3V LDO, too ... or can add jumpers</li>
<li>radio configuration where there's a relay that is constantly 'on' on top of a pole ... powered by 12V bat ... 12V bat being the go-to off-grid battery ...</li>
<li>reorient the power VIN + GND so that the cable will trail / orient towards the ground allowing a vertical antenna? add a mechanical relief location?</li>
<li><strong>BIG</strong> -- caps on power circuit should be 1uF.  Pin order messed up on MCP1700.</li>
<li>soldering the RFM95 -- really need to 'flood' the casselated pins in order for them to be connected properly -- would be good to have a diagnostic</li>
</ul>
<h2>KiCAD notes</h2>
<h3>Custom footprint as logo in KiCAD</h3>
<p>Use the 'Bitmap to component converter' in the main KiCad window (the bitmappy-looking 'a' in the below screenshot) to convert a bitmap to a footprint.  Then you can import this footprint directly to the PCB layout (no need to have an associated symbol), as a logo.</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/converter.png"> <img src="/img/mothbot/converter.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Screenshot highlighting the 'bitmap to component converter'</td>
</tr>
</tbody>
</table>
<h3>Design Rules / Templates for OSHPark</h3>
<p><a href="https://docs.oshpark.com/design-tools/kicad/kicad-design-rules/">This guide</a> has some nice info.</p>
<h2>Reference for QWIIC connector</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/qwiic.png"> <img src="/img/mothbot/qwiic.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sparkfun 'QWIIC' I2C Connector</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/qwiic_board.png"> <img src="/img/mothbot/qwiic_board.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sparkfun 'QWIIC' I2C Connector</td>
</tr>
</tbody>
</table>
<p><a href="https://www.sparkfun.com/qwiic">Sparkfun QWIIC reference</a></p>
<p><a href="https://www.adafruit.com/product/4208">JST SH 4 Pin Connector</a></p>
<p><a href="https://www.adafruit.com/product/4210">Adafruit reference for JST SH 4 Pin QWIIC Pin Ordering</a></p>
<h2>Adding a reset button</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/reset_button.png"> <img src="/img/mothbot/reset_button.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Footprint for KMR2 pushbutton</td>
</tr>
</tbody>
</table>
<h2>Adding a DC-DC converter footprint</h2>
<p><a href="https://www.adafruit.com/product/1065">TSR12450 Converter</a> -- 5V output</p>
<p><a href="https://www.adafruit.com/product/1066">TSR12433 Converter</a> -- 3.3V output</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/dc_dc.png"> <img src="/img/mothbot/dc_dc.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Pinout for DC-DC</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/dcdc_bottom.png"> <img src="/img/mothbot/dcdc_bottom.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Footprint for DC-DC</td>
</tr>
</tbody>
</table>
<hr>
<h2>Misc Notes</h2>
<h3>Aside on STM32</h3>
<p>Nice note on <a href="https://jeelabs.org/2015/11/25/pi-based-stm32f103-development/index.html">STM32 boards</a> from Jeenode, by the way.</p>
<h3>Installing Arduino Libraries</h3>
<p>Adafruit tutorail on installing Arduino libraries <a href="https://learn.adafruit.com/adafruit-all-about-arduino-libraries-install-use">here</a>.</p>
<hr>
<h2>Sensor notes</h2>
<h3>HC-SR04</h3>
<p><a href="https://www.adafruit.com/product/3942">Adafruit page</a></p>
<h3>SHT10</h3>
<p><a href="https://www.adafruit.com/product/1298">Adafruit page</a></p>
<h3>AM2315</h3>
<p><a href="https://github.com/adafruit/Adafruit_AM2315">Adafruit library</a></p>
<hr>
<h2>Mothbot Version 1.0 Notes</h2>
<p>Made explicit i2c header that will allow for display.  But this means that certain i2c sensors are no longer useful via screw terminal.  But, added a 'qwiic' connector for i2c ... so maybe what we do is to make a qwiic adapter for AM2315 (i2c version).</p>
<p>Might need to change screw terminal size to 5mm, as they're far easier to source, it seems ...</p>
<p>Consider placing mounting holes at proper separation for 3XAA battery holder mounting holes ...</p>
<hr>
<h2>Mothbot Version 2.0 Notes</h2>
<ol>
<li>Need bigger spacing on MCP1700 footprint</li>
<li>Need C1 &amp; R1 to be 0.1 uF and 10K (as they are), apparently, for bootloader to auto-reset properly (timing issue?)</li>
<li>Note: I cannibalized C1 from a ver 1.0 Mothbot, need to replace!</li>
<li>Reset button doesn't seem to work?</li>
<li>Swapped A4 &amp; A5 (they are SDA and SCL, not SCL and SDA, respectively) -- need to fix in order for monitor to work</li>
<li>Add 0.1&quot; headers for all terminals, as per i2c ... space as per breadboard?</li>
<li>Match mounting hole spacing to battery pack?</li>
<li>Nice <a href="https://jeelabs.org/2013/05/16/measuring-the-battery-without-draining-it/index.html">note</a> on measuring the battery level without draining it.</li>
</ol>
<hr>
<h2>Mothbot Version 3.0 Notes</h2>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/version3_draft.png"> <img src="/img/mothbot/version3_draft.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">First stab at version 3.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/3drender.png"> <img src="/img/mothbot/3drender.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3D Render of Final for Verison 3.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/mothbot_top.png"> <img src="/img/mothbot/mothbot_top.png" alt="parts.jpg"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Final of version 3, as submitted to OSHPARK. Board design files are <a href="https://github.com/edgecollective/dippy-slim/tree/master/ver3">here</a></td>
</tr>
</tbody>
</table>
<p>Update (13 OCT 2020):  Version 3 passed the following tests:</p>
<ul>
<li>Power</li>
<li>Programmable</li>
<li>LoRa Radio</li>
<li>i2c port</li>
<li>i2c Screen</li>
<li>D4 works</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/mothbot_v3_mvp.png"> <img src="/img/mothbot/mothbot_v3_mvp.png" alt="figA2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Minimal version of the Mothbot version 3.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/ver3_success.png"> <img src="/img/mothbot/ver3_success.png" alt="figA2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Mothbot Version 3 seems to work! See the Mothbot Version 3 <a href="https://youtu.be/YAIVfK-kL4o">initial build video</a>.</td>
</tr>
</tbody>
</table>
<p>Things to change:</p>
<ul>
<li>make the resistor footprints longer so that they can lie flat</li>
<li>larger text for the scre terminals</li>
<li>J1 and J3 terminals are obscured by i2c display -- move stuff?</li>
</ul>
<h3>Notes on Display</h3>
<ul>
<li>Current (larger) display is nice, but prevents access to screw terminals. Uses 'VCC GND SCL SDA'</li>
<li>Can add a rearranged i2c port at the 'top' of U3 (the ATMEGA), arranged as 'GND VCC SCL SDA', and accommodate a <a href="https://www.amazon.com/Pieces-Display-Module-SSD1306-3-3V-5V/dp/B08CDN5PSJ/ref=sr_1_8?dchild=1&amp;keywords=SSD1306&amp;qid=1602675432&amp;sr=8-8">smaller screen</a>.</li>
<li>Note: 'GND VCC SCL SDA' <a href="https://www.amazon.com/Display-Module-SSD1306-Du-pont-Arduino/dp/B07VDXYDVY/ref=sr_1_9?dchild=1&amp;keywords=SSD1306&amp;qid=1602675432&amp;sr=8-9">is also common</a> for the larger displays.</li>
</ul>
<p>So, maybe we switch over to 'GND VCC SCL SDA' in general, move pins to above U3.</p>
<h3><a name="mothbot_ver3_parts"></a> Mothbot Version 3 Parts List / BOM</h3>
<ul>
<li><a href="https://docs.google.com/spreadsheets/d/10DjISUPHa8-PfmeBYISGM-iekXHcvAeN48qu73FdD7M/edit?usp=sharing">BOM in spreadsheet form</a>. Includes link to PCB files on github and for ordering via OSHPark.</li>
</ul>
<p>Some of the parts list on Amazon:</p>
<p>Aside: some of the Mothbot parts via Amazon:</p>
<ul>
<li><a href="https://www.amazon.com/gp/product/B07VWQY6GG/ref=ppx_yo_dt_b_asin_title_o01_s00?ie=UTF8&amp;psc=1">the rfm95</a></li>
<li><a href="https://www.amazon.com/gp/product/B07X4ZTRD2/ref=ppx_yo_dt_b_asin_title_o01_s01?ie=UTF8&amp;psc=1">inexpensive FTDI clone</a></li>
<li><a href="https://www.amazon.com/gp/product/B07MD9G9LG/ref=ppx_yo_dt_b_asin_title_o02_s00?ie=UTF8&amp;psc=1">cute helical antennae</a></li>
<li><a href="https://www.amazon.com/gp/product/B00M1E0FVM/ref=ppx_yo_dt_b_asin_title_o08_s00?ie=UTF8&amp;psc=1">MCP1700 voltage reg</a></li>
<li><a href="https://www.amazon.com/gp/product/B00SWK2HCO/ref=ppx_yo_dt_b_asin_title_o09_s00?ie=UTF8&amp;psc=1">Crystal</a></li>
<li><a href="https://www.amazon.com/gp/product/B01263IMU8/ref=ppx_yo_dt_b_asin_title_o02_s00?ie=UTF8&amp;psc=1">328p w/ Arduino UNO bootloader</a></li>
</ul>
<p>Also:</p>
<ul>
<li><a href="https://www.amazon.com/gp/product/B076MSLFC9/ref=ppx_yo_dt_b_asin_title_o08_s00?ie=UTF8&amp;psc=1">Heltec Wifi + Lora based on ESP32</a></li>
</ul>
<p>Update 14 OCT 2020:</p>
<table>
<thead>
<tr>
<th style="text-align:center"><a href="/img/mothbot/feather_and_mothbot_talking.mp4"> <img src="/img/mothbot/mothbot_success.png" alt="figA2"></a></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Sands Fish's build of the Mothbot!</td>
</tr>
</tbody>
</table>
<hr>
<h2>Misc</h2>
<p>Using Electron to talk to serial port:</p>
<ul>
<li><a href="https://github.com/serialport/electron-serialport.git">Nice example</a></li>
<li><a href="https://www.electronjs.org/community#boilerplates">Electron boilerplates</a></li>
<li><a href="https://hackernoon.com/arduino-serial-data-796c4f7d27ce">Read the serialport using NodeJS</a></li>
<li><a href="https://girishjoshi.io/post/access-serialport-from-electron-application-and-creating-gui-for-micropython-repl-on-esp8266/">Full project on using Electron with serialport</a> &lt;--- this is the one to try</li>
</ul>
<h2>Work Log</h2>
<hr>
<p>Oct 24 2020</p>
<p>Created dimensions document for Mothbot ver 0.1, <a href="https://github.com/edgecollective/dippy-slim/blob/master/ver1/mothbot_dim/mothbot_dim.pdf">here</a>.</p>
<hr>
<p>NOV 16 2020</p>
<p>Photo of latest version in action here:</p>
<p><img src="/img/mothbot/mothbot_am2315.jpg" alt=""></p>


    </div>
  </body>
</html>
