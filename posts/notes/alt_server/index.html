

<!-- feed it through our cssmin filter to minify -->
<style>
  body{font-family:sans-serif;margin:20px;font-size:small;width:90%;margin-right:auto;margin-left:auto;padding-top:15px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:small;margin-bottom:1px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding-right:20px}.post .post-contents{background:#f7f7f7;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}.post .text{height:200px;padding:20px}@media (max-width:680px){.post{width:100%}}body{font:13px/1.5 Verdana,Helvetica,Arial,sans-serif;width:80%}.img-with-caption{font-size:14px;text-align:center;margin:20 0;background-color:F1F1F1;padding:10px}#pullout{text-align:center}#intro{max-width:700px;display:inline-block;text-align:left}#post-content{max-width:800px}#profile_pic{float:right;margin:0 0 1em 1em}h1{line-height:1em;font-size:x-large;margin-bottom:.31em}h2{font-size:large;margin-bottom:1px}h3{font-size:medium;margin-bottom:1px}ol,ul{max-width:650px}a{text-decoration:none}a:hover{text-decoration:underline}a:visited{color:#00f}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.posts-area{width:100%;padding-top:10px}.posts-area:after{content:"";display:table;clear:both}.post{float:left;width:33.33%;padding:0 20px 20px 0}.contribute{width:100%;padding-top:10px}.post .post-contents{border-radius:10px;padding:20px 20px 10px 20px}.post .project-contents{background:#add8e6;border-radius:10px;padding:20px 20px 10px 20px}.post .podcast-contents{background:#e9967a;border-radius:10px;padding:20px 20px 10px 20px}.post .note-contents{background:#e6e6fa;border-radius:10px;padding:20px 20px 10px 20px}.post .pedagogy-contents{background:#90ee90;border-radius:10px;padding:20px 20px 10px 20px}.post .talk-contents{background:pink;border-radius:10px;padding:20px 20px 10px 20px}.post .inter-contents{background:#add8e6;border-radius:5px}.post .image a{display:block;overflow:hidden;height:214px}.post img{object-fit:cover;width:100%;height:100%}img{max-height:500px;max-width:100%}table{margin:30 auto 30 auto;padding:10px;width:60%;text-align:left}td{padding:10px;text-align:left;font-size:12}.post .text{min-height:250px;padding:5px}.post .inter-text{height:250px}audio{width:100%;height:30px}@media (max-width:1100px){.post{width:100%}table{width:100%}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" type="image/x-icon" href="/img/edge_favicon.png" />
    <title>Edge Collective</title>
  </head>
  <body>

    <div id='post-content'>

  <a href="/">Edge Collective</a>
        <h1>P2P / DIY Server</h1>

  
  <p>Repo is <a href="https://gitlab.com/dwblair/p2p-farm-server">here</a>.</p>
<p>A useful associted 'PUT' script is <a href="https://gist.github.com/dwblair/4cfbcc993fafcd4d984058ae730ee342">here</a></p>
<h2>ESP32 --&gt; Server</h2>
<p>Adding headers to esp32 explanation <a href="https://techtutorialsx.com/2018/01/03/esp32-arduino-basic-authentication/">here</a></p>
<p>Making a PUT request <a href="https://techtutorialsx.com/2019/01/07/esp32-arduino-http-put-request/">here</a>.</p>
<p>Using ArduinoJSON with HTTPClient <a href="https://arduinojson.org/v6/how-to/use-arduinojson-with-httpclient/">here</a>.</p>
<p>Creating nested json objects in ArduinoJSON <a href="https://arduinojson.org/v5/faq/how-to-create-complex-nested-objects/">here</a>.</p>
<h2>Work Log</h2>
<hr>
<p>21 OCT 2020</p>
<p>Fixed sqlite3 missing module.</p>
<p>Got an ESP32 to post data via JSON, <a href="https://github.com/edgecollective/esp32-p2p-farm/tree/main/test_put_json">here</a>.</p>
<hr>
<p>23 OCT 2020</p>
<p>Trying to use <a href="https://github.com/fastify/fastify-basic-auth">this fastify basic auth module</a> as part of the codebase.</p>
<p>... implemented!</p>
<hr>
<p>24 OCT 2020</p>
<p>Some next steps:</p>
<ul>
<li>Make a video explanation of the idea.</li>
<li>Work out the storage math, and the economics of storage space.</li>
<li>This might provide a motivation for using the hyper protocol!</li>
<li>Put demo code on the site for using Python, and ESP32, CircuitPy, curl to upload data.</li>
<li>Put it at EC subdomain, or something separate.</li>
<li>Add CSV export</li>
<li>Add JSON export (already there mostly)</li>
<li>Add simple graphing</li>
<li>Add simple metrics (size of file, timespan of datafile, num datapoints)</li>
<li>Add human-readable timestamp (at least e.g. in CSV export)</li>
</ul>
<hr>
<p>25 OCT 2020</p>
<p>Making a python PUT script.</p>
<p>Reference on python requests <a href="https://requests.readthedocs.io/en/master/user/authentication/">here</a>.</p>
<p>Setting the authorization header in curl <a href="https://stackoverflow.com/questions/3044315/how-to-set-the-authorization-header-using-curl">here</a>.</p>
<p>Issue: when using basic auth in current basicAuth branch, it is putting the username password authentication method on top of <em>every</em> request -- need to do it just for the home page.</p>
<p>Guide to using basic auth <a href="https://github.com/fastify/fastify-basic-auth">here</a>.</p>
<p>Combining fastify static with fastify basic auth <a href="https://github.com/fastify/help/issues/190">here</a>.</p>
<p>Using multiple authentication options with fastify <a href="https://github.com/fastify/fastify-auth#usage">here</a></p>
<p>addhook onresponse by route <a href="https://github.com/fastify/fastify/issues/1828">here</a></p>
<p>fastify and mongodb <a href="https://www.fastify.io/docs/v3.4.x/Getting-Started/">here</a></p>
<p>Might just need to find a way to serve up web page from directly in fastify, using basicAuthFix branch</p>
<p>Nice <a href="https://www.fastify.io/docs/v3.4.x/Getting-Started/">getting started with fastify</a> document.</p>
<p>Currently the action is in 'main.js' ...</p>
<p>Looks like there is a way to addHook to specific routes <a href="https://github.com/fastify/fastify/blob/master/docs/Hooks.md#onroute">here</a></p>
<p>latest idea:  keep basicAuth branch as-is, but use multiple authentication methods in 'PUT' script</p>
<p>'ctrl shift i' will insert timestamp in VS Code given installation of an extension <a href="https://stackoverflow.com/questions/38780057/how-to-insert-current-date-time-in-vscode#:~:text=To%20insert%20current%20date%20and,Insert%20DateTime%20then%20press%20Enter%20.&amp;text=By%20default%20you%20don't%20have%20to%20set%20anything.">here</a></p>
<p>Adding multiple authorization headers via postman <a href="https://stackoverflow.com/questions/29282578/multiple-http-authorization-headers">here</a></p>
<p>Combining multiple authorizations via curl <a href="https://stackoverflow.com/questions/22229996/basic-http-and-bearer-token-authentication">here</a></p>
<p>Setting multiple headers in curl -- useful! -- <a href="https://www.shellhacks.com/curl-add-header-multiple-headers-authorization/">here</a></p>
<p>issues:</p>
<ol>
<li>can't use multiple authorization schemes, in particular not if one of them is Basic Auth</li>
<li>not sure how to combine basic auth with fastify-static</li>
</ol>
<p>interesting angle mentioned in <a href="https://stackoverflow.com/questions/64201513/transform-response-of-fastify-static-served-files">&quot;Transform response of fastify-static served files&quot;</a>, which led to fastify <a href="https://github.com/fastify/point-of-view">point-of-view templates idea</a>.</p>
<p>Ah -- I think I've got it working with the basicAuth branch, now!</p>


    </div>
  </body>
</html>
